{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block breadcrumbs %}{% endblock %}

{% block content %}
  <div class="container mt-4">
    <h1 class="mb-4">Asignar Eventos: {{ equipoLocal.0.nuevo_club.nombre }} vs {{ equipoVisita.0.nuevo_club.nombre }} - {{ encuentro.fecha }} </h1>

    <form method="post" action="{% url 'asignarEventos' encuentro_id=encuentro.encuentro_id %}">
      {% csrf_token %}

      <div class="row">
        <div class="col-md-6">
          <label for="tipo_evento">Tipo de Evento:</label>
          <select name="tipo_evento" id="tipo_evento" class="form-control">
            {% for tipo_evento in tipos_evento_relacionados %}
              <option value="{{ tipo_evento.tipo_evento_id }}">
                {{ tipo_evento.nombre }}
              </option>
            {% endfor %}
          </select>
        </div>
      </div>

      <div class="row">
        <div class="col-md-6">
          <label for="tiempo_reglamentario">Tiempo:</label>
          <input name="tiempo_reglamentario" id="tiempo_reglamentario" class="form-control" type="time" step="1" required>
        </div>
      </div>

      <div class="row">
        <div class="col-md-6">
          <label for="motivo">Motivo:</label>
          <input type="text" name="motivo" id="motivo" class="form-control">
        </div>
      </div>


      <div class="row">
        <div class="col-md-6">
          <div>
            <label for="equipoLocal">Alineación 01:</label>
            <select name="equipoLocal[]" id="equipoLocal" multiple>
              {% for jugador in equipoLocal %}
                {% if tipo_evento_id == 3 %}
                  <option value="{{ jugador.persona.persona_id }}">{{ jugador.persona.nombre }} - {{ jugador.posicion_jugador }} - Dorsal: {{ jugador.dorsal }} - local local</option>
                {% else %}
                  <option value="{{ jugador.persona.persona_id }}">{{ jugador.persona.nombre }} - {{ jugador.posicion_jugador }} - Dorsal: {{ jugador.dorsal }}</option>
                {% endif %}
              {% endfor %}
            </select>
          </div>
        </div>
      </div>
      
      <div class="row">
        <div class="col-md-6">
          <div>
            <label for="equipoVisita">Alineación 02:</label>
            <select name="equipoVisita[]" id="equipoVisita" multiple>
              {% for jugador in equipoVisita %}
                {% if tipo_evento_id == 37 %}
                  <option value="{{ jugador.persona.persona_id }}">{{ jugador.persona.nombre }} - {{ jugador.posicion_jugador }} - Dorsal: {{ jugador.dorsal }} - visitante visitante</option>
                {% else %}
                  <option value="{{ jugador.persona.persona_id }}">{{ jugador.persona.nombre }} - {{ jugador.posicion_jugador }} - Dorsal: {{ jugador.dorsal }}</option>
                {% endif %}
              {% endfor %}
            </select>
          </div>
        </div>
      </div>

      <div class="text-right mt-4">
        <button type="submit" class="btn btn-primary">Guardar</button>
        <a href="{% url 'lista_encuentros' %}?tipo=eventos" class="btn btn-secondary">Cancelar</a>
      </div>
    </form>

    <h2>Eventos Guardados</h2>
    <table class="table" id="eventTable">
      <thead>
        <tr>
          <th>Tipo de Evento</th>
          <th>Tiempo Reglamentario</th>
          <th>Local</th>
          <th>Visitante</th>
          <th>Motivo</th>
          <th>Cantidad</th>


        </tr>
      </thead>
      <tbody>
        {% for evento in eventos_obj %}
          <tr>
            <td>{{ evento.tipo_evento_id.nombre }}</td>
            <td>{{ evento.tiempo_reglamentario }}</td>
            <td>{{ evento.motivo }}</td>
            <td>{{ evento.cantidad }}</td>
            <td>{{ evento.alineacion1_id.contrato_id.persona.nombre }}</td>
            <td>{{ evento.alineacion2_id.contrato_id.persona.nombre }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

{% endblock %}
